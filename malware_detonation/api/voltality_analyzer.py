import os
import subprocess


class VoltalityAnalyzer:
    def __init__(self, mem_file, profile):
        self.mem_file = mem_file
        self.profile = profile

    def analyze(self, command):
        if not os.path.isfile(self.mem_file):
            return {'error': 'Memory dump file not found.'}

        cmd = f"volatility -f {self.mem_file} --profile={self.profile} {command}"
        try:
            output = subprocess.check_output(cmd, shell=True).decode()
        except subprocess.CalledProcessError as e:
            return {'error': 'Volatility error: ' + str(e)}

        return {'info': output}