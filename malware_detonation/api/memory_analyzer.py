import os
import subprocess


class MemoryAnalyzer:
    def __init__(self):
        self.mem_file = self.mem_generator()

    def analyze(self):
        if not os.path.isfile(self.mem_file):
            return {'error': 'Memory dump file not found.'}

        cmd = f"volatility -f {self.mem_file} imageinfo"
        output = subprocess.check_output(cmd, shell=True).decode()

        if 'WARNING' in output:
            return {'error': 'Volatility error: ' + output}

        return {'info': output}

    def mem_generator(self):
        return "/path/to/mem_file"
