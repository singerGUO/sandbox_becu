from api.file_handler import FileHandler
from api.static_analyzer import StaticAnalyzer
from api.memory_analyzer import MemoryAnalyzer
from api.tcpdump_analyzer import TCPDumpAnalyzer
from api.voltality_analyzer import VolatilityAnalyzer
from api.report_generator import ReportGenerator

class FileAnalyzer:
    def __init__(self):
        self.file_handler = FileHandler()
        self.static_analyzer = StaticAnalyzer()
        self.memory_analyzer = MemoryAnalyzer()
        self.tcpdump_analyzer = TCPDumpAnalyzer()
        self.voltality_analyzer = VolatilityAnalyzer()
        self.report_generator = ReportGenerator()

    def analyze_file(self, file):
        self.file_handler.handle_file(file)
        static_report = self.static_analyzer.analyze_file(file.filename)
        memory_report = self.memory_analyzer.analyze_file(file.filename)
        tcpdump_report = self.tcpdump_analyzer.analyze_file(file.filename)
        volatility_report = self.voltality_analyzer.analyze_file(file.filename)
        report = self.report_generator.generate_report(
            file.filename,
            static_report,
            memory_report,
            tcpdump_report,
            volatility_report
        )
        return report