import os
import subprocess


class TcpdumpAnalyzer:
    def __init__(self, pcap_file):
        self.pcap_file = pcap_file

    def analyze(self):
        if not os.path.isfile(self.pcap_file):
            return {'error': 'Pcap file not found.'}

        cmd = f"tcpdump -r {self.pcap_file}"
        try:
            output = subprocess.check_output(cmd, shell=True).decode()
        except subprocess.CalledProcessError as e:
            return {'error': 'Tcpdump error: ' + str(e)}

        return {'info': output}